{% extends "base.html" %} {% block title %}Manage Parking Lots - Admin{%
endblock %} {% block content %}
<div class="row mb-4">
  <div class="col-12" style="color: #dfd0b8">
    <h2><i class="fas fa-building me-2"></i>Manage Parking Lots</h2>
  </div>
</div>

<!-- Add New Parking Lot Form -->
<div class="row mb-4">
  <div class="col-12">
    <div class="card">
      <div
        class="card-header"
        style="background-color: #948979; color: #222831"
      >
        <h5><i class="fas fa-plus me-2"></i>Add New Parking Lot</h5>
      </div>
      <div class="card-body" style="background-color: #dfd0b8; color: #222831">
        <form method="POST">
          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="location_name" class="form-label">Location Name</label>
              <input
                type="text"
                class="form-control"
                id="location_name"
                name="location_name"
                required
                style="background-color: #eee7d9; border: 1px solid #393e46"
              />
            </div>
            <div class="col-md-6 mb-3">
              <label for="hourly_rate" class="form-label">Price per Hour</label>
              <input
                type="number"
                step="0.01"
                class="form-control"
                id="hourly_rate"
                name="hourly_rate"
                required
                style="background-color: #eee7d9; border: 1px solid #393e46"
              />
            </div>
          </div>
          <div class="row">
            <div class="col-md-8 mb-3">
              <label for="address" class="form-label">Address</label>
              <input
                type="text"
                class="form-control"
                id="address"
                name="address"
                required
                style="background-color: #eee7d9; border: 1px solid #393e46"
              />
            </div>
            <div class="col-md-4 mb-3">
              <label for="pin_code" class="form-label">Pin Code</label>
              <input
                type="text"
                class="form-control"
                id="pin_code"
                name="pin_code"
                required
                style="background-color: #eee7d9; border: 1px solid #393e46"
              />
            </div>
          </div>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="total_spots" class="form-label"
                >Maximum Number of Spots</label
              >
              <input
                type="number"
                class="form-control"
                id="total_spots"
                name="total_spots"
                required
                style="background-color: #eee7d9; border: 1px solid #393e46"
              />
            </div>
            <div class="col-md-4">
              <button
                type="submit"
                class="btn mt-4"
                style="background-color: #948979; color: #222831"
              >
                <i class="fas fa-plus me-2"></i>Create Parking Lot
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Existing Parking Lots -->
<div class="row">
  <div class="col-12">
    <div class="card">
      <div
        class="card-header"
        style="background-color: #948979; color: #222831"
      >
        <h5><i class="fas fa-list me-2"></i>Existing Parking Lots</h5>
      </div>
      <div class="card-body" style="background-color: #dfd0b8; color: #222831">
        {% if parking_lots %}
        <div class="table-responsive">
          <table class="table table-hover">
            <thead style="background-color: #948979; color: #222831">
              <tr>
                <th>Location Name</th>
                <th>Address</th>
                <th>Pin Code</th>
                <th>Price/Hour</th>
                <th>Total Spots</th>
                <th>Available Spots</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              {% for lot in parking_lots %}
              <tr>
                <td>
                  <div class="d-flex justify-content-between align-items-center">
                    <div>
                      <strong>{{ lot.location_name }}</strong>
                      <p class="text-muted mb-0">{{ lot.address }}, {{ lot.pin_code }}</p>
                    </div>
                    <div>
                      <span class="badge bg-primary me-2"
                        >₹ {{ "%.2f"|format(lot.hourly_rate) }} / hour</span
                      >
                      <span class="badge bg-secondary"
                        >{{ lot.total_spots }} spots</span
                      >
                    </div>
                  </div>
                </td>
                <td>{{ lot.address }}</td>
                <td>{{ lot.pin_code }}</td>
                <td>₹ {{ "%.2f"|format(lot.hourly_rate) }}</td>
                <td>
                  <span class="badge" style="background-color: #222831"
                    >{{ lot.total_spots }}</span
                  >
                </td>
                <td>
                  {% set available_spots = lot.spots|selectattr('status',
                  'equalto', 'A')|list|length %}
                  <span class="badge" style="background-color: #222831"
                    >{{ available_spots }}</span
                  >
                </td>
                <td>
                  <div class="btn-group" role="group">
                    <a
                      href="{{ url_for('admin_parking_spots', lot_id=lot.id) }}"
                      class="btn btn-sm btn-outline-info"
                      title="View Spots"
                    >
                      <i class="fas fa-eye"></i>
                    </a>
                    <a
                      href="{{ url_for('edit_parking_lot', lot_id=lot.id) }}"
                      class="btn btn-sm btn-outline-warning"
                      title="Edit"
                    >
                      <i class="fas fa-edit"></i>
                    </a>
                    <a
                      href="{{ url_for('delete_parking_lot', lot_id=lot.id) }}"
                      class="btn btn-sm btn-outline-danger"
                      title="Delete"
                      onclick="return confirm('Are you sure you want to delete this parking lot? This action cannot be undone.')"
                    >
                      <i class="fas fa-trash"></i>
                    </a>
                  </div>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        {% else %}
        <div class="text-center py-4" style="color: #dfd0b8">
          <i class="fas fa-building fa-3x text-muted mb-3"></i>
          <h5 class="text-muted">No Parking Lots Created</h5>
          <p class="text-muted">
            Create your first parking lot using the form above.
          </p>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
